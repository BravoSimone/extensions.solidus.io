<html>
<head>
  <style>
    body {
      font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
      font-size: 1rem;
      line-height: 1.5;
      color: #373a3c;
    }
    table {
      width: 960px;
      margin: auto;
      border-collapse: separate;
      border-spacing: 12px 5px;
    }
    td, th {
      text-align: left;
      padding: .75rem;
      line-height: 1.5;
      vertical-align: top;
    }
    th.name {
      text-align: right;
    }
    .status {
      color: white;
    }
    .success {
      background-color: #60b541;
    }
    .pending {
      background-color: #909BD4;
    }
    .unsupported {
    }
    .failed {
      background-color: #c82626;
    }
    a {
      color: inherit;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <table>
    <thead>
      <tr>
        <th></th>
        <th></th>
        <% VERSIONS.each do |version| %>
          <th>Solidus <%= version %></th>
        <% end %>
      </tr>
    </thead>
    <tbody>
      <% PROJECTS.each do |project| %>
        <% branches = project.branches %>
        <tr>
          <th class="name" rowspan="<%= branches.size + 1%>">
            <a href="<%= project.github_url %>"><%= project.shortname %></a>
          </th>
        </tr>
        <% branches.each do |branch| %>
          <tr>
            <td><%= branch.name %></td>
            <% VERSIONS.each do |version| %>
              <% jobs = branch.last_build.jobs_for(solidus_version: version) %>
              <% if jobs.none? %>
                <td class="status unsupported"></td>
              <% elsif jobs.any?(&:pending?) %>
                <td class="status pending">pending</td>
              <% elsif jobs.all?(&:passed?) %>
                <td class="status success">passed</td>
              <% else %>
                <td class="status failed">failed</td>
              <% end %>
            <% end %>
          </tr>
        <% end %>
      <% end %>
    </tbody>
  </table>
</body>
</html>
